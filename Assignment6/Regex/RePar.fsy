%{
 open Absyn;
%}

%token <char> CHAR

%token EPS
%token STAR
%token CHOICE
%token LPAR RPAR 

%nonassoc CHOICE
%left STAR

%start Main
%type <Absyn.re> Main RegExp
%%

Main:
  RegExpr EOF             { $1             }
;

RegExp:
    RegExp RegExp         { Seq($1, $2)    }
  | CHAR                  { $1             }
  | LPAR RegExp RPAR      { $2             }
  | RegExp CHOICE RegExp  { Choice($1, $3) }
  | RegExp STAR           { Star($1)       }
;
