%{
 open Absyn;
%}

%token <char> CHAR

%token EPS
%token STAR
%token CHOICE
%token LPAR RPAR 

%nonassoc CHOICE
%left STAR

%start Main
%type <Absyn.re> Main RegExpr
%%

Main:
  RegExpr EOF             { $1             }
;

RegExpr:
    RegExrp RegExp        	{ Seq($1, $2)    }
  | CHAR                  	{ $1             }
  | LPAR RegExpr RPAR     	{ $2             }
  | RegExpr CHOICE RegExpr  { Choice($1, $3) }
  | RegExpr STAR           	{ Star($1)       }
;
